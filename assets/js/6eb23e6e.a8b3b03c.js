"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[959],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>u,MDXProvider:()=>d,mdx:()=>h,useMDXComponents:()=>m,withMDXComponents:()=>c});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a.apply(this,arguments)}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=r.createContext({}),c=function(e){return function(n){var t=m(n.components);return r.createElement(e,a({},n,{components:t}))}},m=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=m(e.components);return r.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=m(t),d=o,f=c["".concat(s,".").concat(d)]||c[d]||p[d]||a;return t?r.createElement(f,i(i({ref:n},u),{},{components:t})):r.createElement(f,i({ref:n},u))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=f;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var u=2;u<a;u++)s[u]=t[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},65133:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>u});var r=t(87462),o=(t(67294),t(3905));const a={id:"rules",title:"Rules",sidebar_label:"Rules"},s=void 0,i={unversionedId:"rules",id:"rules",title:"Rules",description:"A rule describes flows that we want to catch (e.g, user input flowing into command execution).",source:"@site/documentation/rules.md",sourceDirName:".",slug:"/rules",permalink:"/docs/rules",draft:!1,editUrl:"https://github.com/facebook/mariana-trench/tree/main/documentation/website/documentation/rules.md",tags:[],version:"current",frontMatter:{id:"rules",title:"Rules",sidebar_label:"Rules"},sidebar:"docs",previous:{title:"Customize Sources and Sinks",permalink:"/docs/customize-sources-and-sinks"},next:{title:"Models & Model Generators",permalink:"/docs/models"}},l={},u=[{value:"Transform Rules",id:"transform-rules",level:3}],c=(m="MultiSourceSinkRule",function(e){return console.warn("Component "+m+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.mdx)("div",e)});var m;const d={toc:u};function p(e){let{components:n,...t}=e;return(0,o.mdx)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("p",null,"A rule describes flows that we want to catch (e.g, user input flowing into command execution).\nA rule is made of a set of source ",(0,o.mdx)("a",{parentName:"p",href:"/docs/models#kinds"},"kinds"),", a set of sink kinds, a name, a code, and a description."),(0,o.mdx)("p",null,"Here is an example of a rule in JSON:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "User input flows into code execution (RCE)",\n  "code": 1,\n  "description": "Values from user-controlled source may eventually flow into code execution",\n  "sources": [\n    "UserCamera",\n    "UserInput",\n  ],\n  "sinks": [\n    "CodeAsyncJob",\n    "CodeExecution",\n  ]\n}\n')),(0,o.mdx)("p",null,"For guidance on modeling sources and sinks, see the next section, ",(0,o.mdx)("a",{parentName:"p",href:"/docs/models"},"Models and Model Generators"),"."),(0,o.mdx)("p",null,"Rules used by Mariana Trench can be specified with the ",(0,o.mdx)("inlineCode",{parentName:"p"},"--rules-paths")," argument. The default set of rules that run can be found in ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/facebook/mariana-trench/blob/main/configuration/rules.json"},"configuration/rules.json"),"."),(0,o.mdx)("h3",{id:"transform-rules"},"Transform Rules"),(0,o.mdx)("p",null,"Some flows are only interesting if they also pass through a specific method. These methods can be modeled as a propagation with transforms. Then, to catch these flows, we specify the ordered list of transforms here in the rule."),(0,o.mdx)("p",null,"Here is an example of a transform rule in JSON:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "URI Query Parameters flow into Internal Intent data",\n  "code": 2,\n  "oncall": "prodsec_mobile",\n  "description": "Values from a query parameter source may eventually flow into Internal Intent data",\n  "sources": [\n    "UriQueryParameter"\n  ],\n  "transforms": [\n    "IntentData"\n  ],\n  "sinks": [\n    "LaunchingFamilyComponent"\n  ]\n}\n')),(0,o.mdx)("p",null,"The flow will only be created if UriQueryParameter flows through IntentData and then into LaunchingFamilyComponent. It will not be created when UriQueryParameter flows into LaunchingFamilyComponent without passing through the IntentData transform."),(0,o.mdx)("p",null,"See ",(0,o.mdx)("a",{parentName:"p",href:"/docs/models#propagation-with-transforms"},"Models and Model Generators")," for how to model transforms."),(0,o.mdx)(c,{mdxType:"MultiSourceSinkRule"}))}p.isMDXComponent=!0}}]);